#!/bin/sh

echo "=== Iniciando WolfbearOS ==="

# Las particiones del sistema se montaron en el launch de initramfs

# Esto corre el Launcher
QT_QPA_PLATFORM=eglfs \
QT_QPA_EGLFS_INTEGRATION=eglfs_kms \
QT_QPA_GENERIC_PLUGINS=evdevmouse,evdevkeyboard \
QT_QPA_EVDEV_MOUSE_PARAMETERS=/dev/input/event2:scale=0.3 \
./LauncherApp &

./launch/run

# Bucle para mantener consola activa
for port in tty1 ttyAMA0; do
  if [ -e "/dev/$port" ]; then
    echo "[ROOTFS] WolfbearOS getty en $port"
    /sbin/getty -L "$port" 115200 vt100 &
  fi
done

# Esperar indefinidamente (para evitar que PID 1 muera)
wait