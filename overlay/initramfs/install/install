#!/bin/sh
set -euo pipefail

TARGET_DISK_DIR="/mnt/target"
CURRENT_PATH=$( pwd )
SCRIPTS_DIR="$( dirname "$0" )/install"

echo "Bienvenido a instalaci√≥n de WolfbearOS"
echo "El proceso comenzar√° en unos momentos"
sleep 0.5

SYS_ARCH=$( ./000-arch-detection )

echo "Hemos detectado que la arquitectura de tu sistema es '$SYS_ARCH'"
sleep 0.5


echo "üîÑ Ejecutando secuencialmente los scripts‚Ä¶"

i=0
while :; do
  # Genera el prefijo con ceros: 000, 001, ..., 010, ...
  prefix=$(printf "%03d" "$i")
  # Buscamos ANY script que empiece con ese prefijo
  # El glob no expande si no hay coincidencias; as√≠ que usamos 'ls' para probar.
  if ls "$SCRIPTS_DIR/${prefix}-"* >/dev/null 2>&1; then
    # Si hay varios, los ejecutamos en orden alfab√©tico
    for script in "$SCRIPTS_DIR/${prefix}-"*; do
      [ -f "$script" ] || continue
      [ -x "$script" ] || { echo "‚ö†Ô∏è  Saltando $script (no es ejecutable)"; continue; }
      echo "‚ñ∂Ô∏è  Ejecutando $script"
      "$script"
    done
    i=$((i + 1))
  else
    # No existe el script con este n√∫mero ‚Üí fin de la secuencia
    echo "‚úÖ Secuencia terminada en $prefix (script no encontrado)."
    break
  fi
done